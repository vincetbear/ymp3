# Railway 環境變數設定指南

## ✅ 已完成的更新

1. ✅ `proxy_config.py` - 已創建代理管理模組
2. ✅ `app.py` - 已更新為使用代理輪替
3. ✅ 移除舊的 `PROXY_URL` 配置

## 🔧 需要在 Railway 設定的環境變數

登入 Railway 控制台:https://railway.app/dashboard

找到你的專案 `vincetbear/ymp3`,進入 **Variables** 設定:

### 必要變數:

```bash
# WebShare 帳號
WEBSHARE_USERNAME=ellpsmsi
WEBSHARE_PASSWORD=5x76u62w6hou

# 代理 IP 清單 (逗號分隔)
PROXY_IPS=23.94.138.113:6387,192.241.104.29:8123
```

### 可選變數:

如果你有更多代理 IP,請全部加入:

```bash
PROXY_IPS=23.94.138.113:6387,192.241.104.29:8123,其他IP:PORT,其他IP:PORT
```

## 📝 重要提醒

1. **刪除舊變數**: 如果有 `PROXY_URL`,請刪除它
2. **IP 格式**: 確保每個 IP 都是 `IP地址:端口` 格式
3. **分隔符號**: 使用英文逗號 `,` 分隔多個 IP
4. **不要有空格**: IP 之間不要有空格

## 🚀 設定完成後

1. 儲存環境變數
2. Railway 會自動重新部署
3. 查看部署日誌,應該會看到:

```
🔒 代理輪替系統已啟動
📊 可用代理數量: 2
📋 代理清單:
  - 23.94.138.113:6387
  - 192.241.104.29:8123
```

## 🧪 測試

部署完成後,訪問:
```
https://你的域名.railway.app/
```

下載時日誌會顯示:
```
🔒 使用代理: ellp***@23.94.138.113:6387
```

## 🆘 疑難排解

### 如果看到 "未設定代理" 警告:

1. 檢查環境變數名稱是否正確 (區分大小寫)
2. 檢查 `PROXY_IPS` 是否有逗號分隔
3. 確認沒有多餘的空格

### 如果代理連接失敗:

1. 登入 WebShare 控制台確認:
   - 帳號是否啟用
   - IP 清單是否正確
   - 流量是否用完

2. 嘗試在本地測試:
```bash
cd web_version
python test_proxy.py
```

## 📊 代理輪替工作原理

每次下載時:
1. 系統從 `PROXY_IPS` 隨機選擇一個 IP
2. 使用 `WEBSHARE_USERNAME` 和 `WEBSHARE_PASSWORD` 認證
3. 格式: `http://用戶名:密碼@IP:端口`
4. 每次下載可能使用不同的 IP,避免單一 IP 被封鎖

## 🎯 下一步

1. 在 Railway 設定環境變數
2. 等待自動部署完成
3. 測試下載功能
4. 如果成功,你的 YouTube 下載工具就可以正常使用了!

---

**提示**: 如果需要添加更多代理 IP,只需編輯 `PROXY_IPS` 變數,添加更多 IP 即可。
